\hypertarget{ds18b20_8c}{
\section{ds18b20.c File Reference}
\label{ds18b20_8c}\index{ds18b20.c@{ds18b20.c}}
}
Driver for ds18b20 one wire temperature sensor. 

{\tt \#include $<$stdio.h$>$}\par
{\tt \#include \char`\"{}ds18b20.h\char`\"{}}\par
{\tt \#include \char`\"{}u1wire.h\char`\"{}}\par
{\tt \#include \char`\"{}delay.h\char`\"{}}\par
{\tt \#include \char`\"{}dscrc8.h\char`\"{}}\par
\subsection*{Defines}
\begin{CompactItemize}
\item 
\#define \hyperlink{ds18b20_8c_355e3b61ef3a823505bce746aceb9de9}{DS18B20\_\-DEBUG}~0
\item 
\#define \hyperlink{ds18b20_8c_b6d62f74d3695a5d6b64067b02070a35}{DS18B20\_\-CRC\_\-CHECK}~0
\end{CompactItemize}
\subsection*{Enumerations}
\begin{CompactItemize}
\item 
enum \{ \hyperlink{ds18b20_8c_dc29c2ff13d900c2f185ee95427fb06cbe39752a242feaed3c73acc3d01831a9}{DS18B20\_\-FAMILY\_\-CODE} =  0x28, 
\hyperlink{ds18b20_8c_dc29c2ff13d900c2f185ee95427fb06c369b26e43ebcf01900811483010a9c9d}{DS1820\_\-FAMILY\_\-CODE} =  0x10, 
\hyperlink{ds18b20_8c_dc29c2ff13d900c2f185ee95427fb06c5432131ecd3ee0ce273053095551c088}{DS18S20\_\-FAMILY\_\-CODE} =  0x10
 \}
\item 
enum \{ \hyperlink{ds18b20_8c_61dadd085c1777f559549e05962b2c9eac120f86e60810e900fd4f962eed6ad2}{DS18B20\_\-SCRATCHPAD\_\-BYTES} =  9
 \}
\item 
enum \{ \hyperlink{ds18b20_8c_726ca809ffd3d67ab4b8476646f26635ad29846733c9596e9d6aedbbee3ffd2e}{DS18B20\_\-CONVERT\_\-T} =  0x44, 
\hyperlink{ds18b20_8c_726ca809ffd3d67ab4b8476646f26635fbfb8058958cb0c196965e41c93772fa}{DS18B20\_\-READ\_\-SCRATCHPAD} =  0xbe, 
\hyperlink{ds18b20_8c_726ca809ffd3d67ab4b8476646f266352aff2e79bd9992414133c75453562c09}{DS18B20\_\-WRITE\_\-SCRATCHPAD} =  0x4e
 \}
\end{CompactItemize}
\subsection*{Functions}
\begin{CompactItemize}
\item 
int8\_\-t \hyperlink{ds18b20_8c_2f1b65191e688161d10a666062d8ceda}{ds18b20\_\-temp\_\-conversion\_\-start} (\hyperlink{structu1wire__obj__t}{u1wire\_\-t} dev)
\item 
bool \hyperlink{ds18b20_8c_c97ff93e5c7bd9890fd336f653a16c11}{ds18b20\_\-temp\_\-ready\_\-p} (\hyperlink{structu1wire__obj__t}{u1wire\_\-t} dev \_\-\_\-attribute\_\-\_\-((unused)))
\item 
int8\_\-t \hyperlink{ds18b20_8c_80d89390202e460337d06cf7023441bb}{ds18b20\_\-temp\_\-read} (\hyperlink{structu1wire__obj__t}{u1wire\_\-t} dev, \hyperlink{ds18b20_8h_a6e2b46ff1ef9e6257bd39e34c98a174}{ds18b20\_\-temp\_\-t} $\ast$ptemp)
\item 
bool \hyperlink{ds18b20_8c_42e8d03d218dc27159c7dbd2517ad6a8}{ds18b20\_\-device\_\-p} (\hyperlink{structu1wire__obj__t}{u1wire\_\-obj\_\-t} $\ast$dev)
\item 
\hyperlink{structu1wire__obj__t}{u1wire\_\-t} \hyperlink{ds18b20_8c_112f54ea0657940d9aa54cf7a1adaa44}{ds18b20\_\-init} (\hyperlink{structu1wire__obj__t}{u1wire\_\-obj\_\-t} $\ast$dev)
\end{CompactItemize}
\subsection*{Variables}
\begin{CompactItemize}
\item 
static uint8\_\-t \hyperlink{ds18b20_8c_75df0ab05d179b6cd82a8da1d9142ee5}{ds18b20\_\-data} \mbox{[}DS18B20\_\-SCRATCHPAD\_\-BYTES\mbox{]}
\end{CompactItemize}


\subsection{Detailed Description}
Driver for ds18b20 one wire temperature sensor. 

\begin{Desc}
\item[Author:]M. P. Hayes, UCECE \end{Desc}
\begin{Desc}
\item[Date:]08 June 2002 \end{Desc}


\subsection{Define Documentation}
\hypertarget{ds18b20_8c_b6d62f74d3695a5d6b64067b02070a35}{
\index{ds18b20.c@{ds18b20.c}!DS18B20\_\-CRC\_\-CHECK@{DS18B20\_\-CRC\_\-CHECK}}
\index{DS18B20\_\-CRC\_\-CHECK@{DS18B20\_\-CRC\_\-CHECK}!ds18b20.c@{ds18b20.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}\#define DS18B20\_\-CRC\_\-CHECK~0}}
\label{ds18b20_8c_b6d62f74d3695a5d6b64067b02070a35}


\hypertarget{ds18b20_8c_355e3b61ef3a823505bce746aceb9de9}{
\index{ds18b20.c@{ds18b20.c}!DS18B20\_\-DEBUG@{DS18B20\_\-DEBUG}}
\index{DS18B20\_\-DEBUG@{DS18B20\_\-DEBUG}!ds18b20.c@{ds18b20.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}\#define DS18B20\_\-DEBUG~0}}
\label{ds18b20_8c_355e3b61ef3a823505bce746aceb9de9}




\subsection{Enumeration Type Documentation}
\hypertarget{ds18b20_8c_dc29c2ff13d900c2f185ee95427fb06c}{
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}anonymous enum}}
\label{ds18b20_8c_dc29c2ff13d900c2f185ee95427fb06c}


Family codes supported by this driver. \begin{Desc}
\item[Enumerator: ]\par
\begin{description}
\index{DS18B20\_\-FAMILY\_\-CODE@{DS18B20\_\-FAMILY\_\-CODE}!ds18b20.c@{ds18b20.c}}\index{ds18b20.c@{ds18b20.c}!DS18B20\_\-FAMILY\_\-CODE@{DS18B20\_\-FAMILY\_\-CODE}}\item[{\em 
\hypertarget{ds18b20_8c_dc29c2ff13d900c2f185ee95427fb06cbe39752a242feaed3c73acc3d01831a9}{
DS18B20\_\-FAMILY\_\-CODE}
\label{ds18b20_8c_dc29c2ff13d900c2f185ee95427fb06cbe39752a242feaed3c73acc3d01831a9}
}]\index{DS1820\_\-FAMILY\_\-CODE@{DS1820\_\-FAMILY\_\-CODE}!ds18b20.c@{ds18b20.c}}\index{ds18b20.c@{ds18b20.c}!DS1820\_\-FAMILY\_\-CODE@{DS1820\_\-FAMILY\_\-CODE}}\item[{\em 
\hypertarget{ds18b20_8c_dc29c2ff13d900c2f185ee95427fb06c369b26e43ebcf01900811483010a9c9d}{
DS1820\_\-FAMILY\_\-CODE}
\label{ds18b20_8c_dc29c2ff13d900c2f185ee95427fb06c369b26e43ebcf01900811483010a9c9d}
}]\index{DS18S20\_\-FAMILY\_\-CODE@{DS18S20\_\-FAMILY\_\-CODE}!ds18b20.c@{ds18b20.c}}\index{ds18b20.c@{ds18b20.c}!DS18S20\_\-FAMILY\_\-CODE@{DS18S20\_\-FAMILY\_\-CODE}}\item[{\em 
\hypertarget{ds18b20_8c_dc29c2ff13d900c2f185ee95427fb06c5432131ecd3ee0ce273053095551c088}{
DS18S20\_\-FAMILY\_\-CODE}
\label{ds18b20_8c_dc29c2ff13d900c2f185ee95427fb06c5432131ecd3ee0ce273053095551c088}
}]\end{description}
\end{Desc}

\hypertarget{ds18b20_8c_61dadd085c1777f559549e05962b2c9e}{
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}anonymous enum}}
\label{ds18b20_8c_61dadd085c1777f559549e05962b2c9e}


Number of bytes including CRC. \begin{Desc}
\item[Enumerator: ]\par
\begin{description}
\index{DS18B20\_\-SCRATCHPAD\_\-BYTES@{DS18B20\_\-SCRATCHPAD\_\-BYTES}!ds18b20.c@{ds18b20.c}}\index{ds18b20.c@{ds18b20.c}!DS18B20\_\-SCRATCHPAD\_\-BYTES@{DS18B20\_\-SCRATCHPAD\_\-BYTES}}\item[{\em 
\hypertarget{ds18b20_8c_61dadd085c1777f559549e05962b2c9eac120f86e60810e900fd4f962eed6ad2}{
DS18B20\_\-SCRATCHPAD\_\-BYTES}
\label{ds18b20_8c_61dadd085c1777f559549e05962b2c9eac120f86e60810e900fd4f962eed6ad2}
}]\end{description}
\end{Desc}

\hypertarget{ds18b20_8c_726ca809ffd3d67ab4b8476646f26635}{
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}anonymous enum}}
\label{ds18b20_8c_726ca809ffd3d67ab4b8476646f26635}


One wire bus commands. \begin{Desc}
\item[Enumerator: ]\par
\begin{description}
\index{DS18B20\_\-CONVERT\_\-T@{DS18B20\_\-CONVERT\_\-T}!ds18b20.c@{ds18b20.c}}\index{ds18b20.c@{ds18b20.c}!DS18B20\_\-CONVERT\_\-T@{DS18B20\_\-CONVERT\_\-T}}\item[{\em 
\hypertarget{ds18b20_8c_726ca809ffd3d67ab4b8476646f26635ad29846733c9596e9d6aedbbee3ffd2e}{
DS18B20\_\-CONVERT\_\-T}
\label{ds18b20_8c_726ca809ffd3d67ab4b8476646f26635ad29846733c9596e9d6aedbbee3ffd2e}
}]\index{DS18B20\_\-READ\_\-SCRATCHPAD@{DS18B20\_\-READ\_\-SCRATCHPAD}!ds18b20.c@{ds18b20.c}}\index{ds18b20.c@{ds18b20.c}!DS18B20\_\-READ\_\-SCRATCHPAD@{DS18B20\_\-READ\_\-SCRATCHPAD}}\item[{\em 
\hypertarget{ds18b20_8c_726ca809ffd3d67ab4b8476646f26635fbfb8058958cb0c196965e41c93772fa}{
DS18B20\_\-READ\_\-SCRATCHPAD}
\label{ds18b20_8c_726ca809ffd3d67ab4b8476646f26635fbfb8058958cb0c196965e41c93772fa}
}]\index{DS18B20\_\-WRITE\_\-SCRATCHPAD@{DS18B20\_\-WRITE\_\-SCRATCHPAD}!ds18b20.c@{ds18b20.c}}\index{ds18b20.c@{ds18b20.c}!DS18B20\_\-WRITE\_\-SCRATCHPAD@{DS18B20\_\-WRITE\_\-SCRATCHPAD}}\item[{\em 
\hypertarget{ds18b20_8c_726ca809ffd3d67ab4b8476646f266352aff2e79bd9992414133c75453562c09}{
DS18B20\_\-WRITE\_\-SCRATCHPAD}
\label{ds18b20_8c_726ca809ffd3d67ab4b8476646f266352aff2e79bd9992414133c75453562c09}
}]\end{description}
\end{Desc}



\subsection{Function Documentation}
\hypertarget{ds18b20_8c_42e8d03d218dc27159c7dbd2517ad6a8}{
\index{ds18b20.c@{ds18b20.c}!ds18b20\_\-device\_\-p@{ds18b20\_\-device\_\-p}}
\index{ds18b20\_\-device\_\-p@{ds18b20\_\-device\_\-p}!ds18b20.c@{ds18b20.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}bool ds18b20\_\-device\_\-p ({\bf u1wire\_\-obj\_\-t} $\ast$ {\em dev})}}
\label{ds18b20_8c_42e8d03d218dc27159c7dbd2517ad6a8}


Return true if the one wire device is a ds18b20 temperature sensor. \begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em dev}]pointer to one wire device \end{description}
\end{Desc}
\begin{Desc}
\item[Returns:]1 if device is a dsb18b20 otherwise 0 \end{Desc}


References DS1820\_\-FAMILY\_\-CODE, DS18B20\_\-FAMILY\_\-CODE, u1wire\_\-rom\_\-code\_\-t::family, u1wire\_\-rom\_\-code\_\-t::fields, and u1wire\_\-obj\_\-t::rom\_\-code.

Referenced by ds18b20\_\-init().\hypertarget{ds18b20_8c_112f54ea0657940d9aa54cf7a1adaa44}{
\index{ds18b20.c@{ds18b20.c}!ds18b20\_\-init@{ds18b20\_\-init}}
\index{ds18b20\_\-init@{ds18b20\_\-init}!ds18b20.c@{ds18b20.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}{\bf u1wire\_\-t} ds18b20\_\-init ({\bf u1wire\_\-obj\_\-t} $\ast$ {\em dev})}}
\label{ds18b20_8c_112f54ea0657940d9aa54cf7a1adaa44}


Initialise ds18b20 temperature sensor. \begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em dev}]pointer to one wire device \end{description}
\end{Desc}
\begin{Desc}
\item[Returns:]pointer to one wire device if device is a ds18b20 temperature sensor otherwise NULL \end{Desc}


References ds18b20\_\-device\_\-p().\hypertarget{ds18b20_8c_2f1b65191e688161d10a666062d8ceda}{
\index{ds18b20.c@{ds18b20.c}!ds18b20\_\-temp\_\-conversion\_\-start@{ds18b20\_\-temp\_\-conversion\_\-start}}
\index{ds18b20\_\-temp\_\-conversion\_\-start@{ds18b20\_\-temp\_\-conversion\_\-start}!ds18b20.c@{ds18b20.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int8\_\-t ds18b20\_\-temp\_\-conversion\_\-start ({\bf u1wire\_\-t} {\em dev})}}
\label{ds18b20_8c_2f1b65191e688161d10a666062d8ceda}


Start a temperature conversion. \begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em dev}]pointer to one wire device object \end{description}
\end{Desc}
\begin{Desc}
\item[Returns:]1 if OK, 0 if no device responding, negative if error \end{Desc}
\begin{Desc}
\item[Note:]The conversion takes 0.75 s for 12 bit resolution. \end{Desc}


References DS18B20\_\-CONVERT\_\-T, and u1wire\_\-command().\hypertarget{ds18b20_8c_80d89390202e460337d06cf7023441bb}{
\index{ds18b20.c@{ds18b20.c}!ds18b20\_\-temp\_\-read@{ds18b20\_\-temp\_\-read}}
\index{ds18b20\_\-temp\_\-read@{ds18b20\_\-temp\_\-read}!ds18b20.c@{ds18b20.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}int8\_\-t ds18b20\_\-temp\_\-read ({\bf u1wire\_\-t} {\em dev}, \/  {\bf ds18b20\_\-temp\_\-t} $\ast$ {\em ptemp})}}
\label{ds18b20_8c_80d89390202e460337d06cf7023441bb}


Read last converted temperature. \begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em dev}]pointer to one wire device \item[{\em ptemp}]pointer for temperature result \end{description}
\end{Desc}
\begin{Desc}
\item[Returns:]1 if OK, 0 if no device responding, negative if error \end{Desc}
\begin{Desc}
\item[Note:]The temperature conversion must be complete. \end{Desc}


References DS1820\_\-FAMILY\_\-CODE, DS1820\_\-TEMP\_\-BITS, ds18b20\_\-data, DS18B20\_\-READ\_\-SCRATCHPAD, DS18B20\_\-SCRATCHPAD\_\-BYTES, DS18B20\_\-TEMP\_\-BITS, dscrc8(), u1wire\_\-rom\_\-code\_\-t::family, u1wire\_\-rom\_\-code\_\-t::fields, u1wire\_\-obj\_\-t::rom\_\-code, u1wire\_\-command(), U1WIRE\_\-ERR\_\-CRC, and u1wire\_\-read().\hypertarget{ds18b20_8c_c97ff93e5c7bd9890fd336f653a16c11}{
\index{ds18b20.c@{ds18b20.c}!ds18b20\_\-temp\_\-ready\_\-p@{ds18b20\_\-temp\_\-ready\_\-p}}
\index{ds18b20\_\-temp\_\-ready\_\-p@{ds18b20\_\-temp\_\-ready\_\-p}!ds18b20.c@{ds18b20.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}bool ds18b20\_\-temp\_\-ready\_\-p ({\bf u1wire\_\-t} dev  {\em \_\-\_\-attribute\_\-\_\-}(unused))}}
\label{ds18b20_8c_c97ff93e5c7bd9890fd336f653a16c11}


Return true when a temperature conversion finished. \begin{Desc}
\item[Parameters:]
\begin{description}
\item[{\em dev}]pointer to one wire device \end{description}
\end{Desc}
\begin{Desc}
\item[Returns:]1 if conversion finished otherwise 0 \end{Desc}


References u1wire\_\-ready\_\-p().

\subsection{Variable Documentation}
\hypertarget{ds18b20_8c_75df0ab05d179b6cd82a8da1d9142ee5}{
\index{ds18b20.c@{ds18b20.c}!ds18b20\_\-data@{ds18b20\_\-data}}
\index{ds18b20\_\-data@{ds18b20\_\-data}!ds18b20.c@{ds18b20.c}}
\subsubsection{\setlength{\rightskip}{0pt plus 5cm}uint8\_\-t {\bf ds18b20\_\-data}\mbox{[}DS18B20\_\-SCRATCHPAD\_\-BYTES\mbox{]}\hspace{0.3cm}{\tt  \mbox{[}static\mbox{]}}}}
\label{ds18b20_8c_75df0ab05d179b6cd82a8da1d9142ee5}




Referenced by ds18b20\_\-temp\_\-read().